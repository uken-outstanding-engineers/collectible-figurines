<mat-toolbar>
    <div class="logo-container">
        <img src="assets/logo.png" class="logo" alt="logo" routerLink="figures-showcase">
        <a routerLink="figures-showcase" class="figures-showcase">       
            <span class="split-text">{{ 'navbar.collectible_figures' | translate }}</span>
        </a>
    </div>

    <div class="spacer"></div>

    <div class="search-container">
        <mat-form-field class="search-input">
          <input 
            matInput 
            placeholder="{{ 'navbar.search_placeholder' | translate }}" 
            [(ngModel)]="searchTerm" 
            (input)="searchFigures()"
            (focus)="onFocus()"
            (blur)="onBlur()"
            (ngModelChange)="onInputChange()"
          >
        </mat-form-field>        
      
        <div class="search-results" *ngIf="showResults && searchResults.length > 0">
          <div 
            class="search-result-item" 
            *ngFor="let figure of searchResults" 
            (mousedown)="selectFigure(figure)">
            
            <img [src]="apiUrl + figure.imageUrl" alt="{{ figure.name }}">
            <span>{{ figure.name }}</span>
          </div>
        </div>
    </div>
      
    <div class="profile-language">
        <button 
            mat-icon-button 
            class="logged-in"
            [matMenuTriggerFor]="menu" 
            [matMenuTriggerData]="{ xPosition: 'center', yPosition: 'above' }"
            *ngIf="isLoggedIn; else loginRedirect"
        >
            <ng-container *ngIf="!this.currentUser?.avatarUrl; else avatarImage">
                <mat-icon fontIcon="person"></mat-icon>
            </ng-container>
            
            <ng-template #avatarImage>
                <img class="avatar" [src]="apiUrl + this.currentUser?.avatarUrl" alt="Profilowe">
            </ng-template>
        </button>

        <ng-template #loginRedirect>
            <button mat-icon-button class="profile-icon" routerLink="/login">
                <mat-icon fontIcon="person"></mat-icon>
            </button>
        </ng-template>

        <mat-menu #menu="matMenu" class="custom-menu">

            <!-- Username -->
            <div class="menu-header">
                <span class="username">{{ currentUser?.username }}</span>
            </div>
    
            <div class="horizontal-divider"></div>
    
            <!-- Admin Panel - only admin -->
            <button mat-menu-item routerLink="/admin" *ngIf="currentUser?.permission === 'ADMIN'">
                <mat-icon>admin_panel_settings</mat-icon>
                <span>{{ 'navbar.admin_panel' | translate }}</span>
            </button>
    
            <!-- Figurine Lists -->
            <button mat-menu-item [routerLink]="['/profile', shareId]">
                <mat-icon>person</mat-icon>
                <span>{{ 'navbar.profile' | translate }}</span>
            </button>

             <!-- Notification -->
            <button mat-menu-item [routerLink]="['/notification']">
                <mat-icon>notifications</mat-icon>
                <span>Notifications</span>
            </button>
    
            <!-- Settings -->
            <button mat-menu-item routerLink="/settings">
                <mat-icon>settings</mat-icon>
                <span>{{ 'navbar.settings' | translate }}</span>
            </button>
    
            <div class="horizontal-divider"></div>
    
            <!-- Logout -->
            <button mat-menu-item (click)="logout()">
                <mat-icon>logout</mat-icon>
                <span>{{ 'navbar.logout' | translate }}</span>
            </button>
        </mat-menu>

        <div class="vertical-divider"></div>
        
        <button mat-button class="language-button" *ngIf="currentLanguage !== 'en'" (click)="changeLanguage('en')">EN</button>
        <button mat-button class="language-button" *ngIf="currentLanguage !== 'pl'" (click)="changeLanguage('pl')">PL</button>
    </div>
</mat-toolbar>

<!-- <mat-toolbar class="menu-toolbar">
    <nav>
        <a mat-button routerLink="news">Nowo≈õci</a> 
        <a mat-button routerLink="">Kategorie</a> 
        <a mat-button routerLink="fandoms">Fandomy</a>
        <a mat-button routerLink="">Ekskluzywne</a>
    </nav>
</mat-toolbar> -->
